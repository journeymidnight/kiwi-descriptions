<?xml version="1.0" encoding="utf-8"?>

<image schemaversion="6.8" name="Cluster-CentOS-07.0">
    <description type="system">
        <author>Bamvor Zhang</author>
        <contact>bamv2005@gmail.com</contact>
        <specification>CentOS Enterprise 7 Cluster base on JeOS(Marcus Schaefer ms@suse.com). merge upstream patch</specification>
    </description>
    <strip type="delete">
        <file name="/usr/lib*/python*"/>
        <file name="/usr/lib*/gconv"/>
        <file name="/usr/share/zoneinfo"/>
        <file name="/usr/share/i18n"/>
        <file name="/lib/i686/nosegneg"/>
        <file name="/lib/kbd"/>
    </strip>
    <preferences>
        <version>0.8.01</version>
        <packagemanager>yum</packagemanager>
        <bootsplash-theme>charge</bootsplash-theme>
        <locale>en_US</locale>
        <keytable>us</keytable>
        <timezone>UTC</timezone>
        <rpm-check-signatures>false</rpm-check-signatures>
        <type image="iso" flags="overlay" hybrid="true" firmware="uefi" hybridpersistent_filesystem="ext4" hybridpersistent="true"/>
        <type image="vmx" primary="true" filesystem="xfs" kernelcmdline="rhgb" bootloader="grub2" firmware="uefi"/>
        <type image="oem" initrd_system="dracut" filesystem="xfs" installiso="true" bootloader="grub2" firmware="uefi">
            <systemdisk>
                <volume name="var" freespace="500M" />
                <volume name="@root" freespace="500M" />
            </systemdisk>
            <oemconfig>
                <oem-swap>false</oem-swap>
            </oemconfig>
        </type>
    </preferences>
    <users>
        <user password="$1$oM/ZHXR.$eXAkhwj6IN46GWHh164Jj0" home="/root" name="root" groups="root"/>
        <user password="$1$TzltPXyA$/biSepUxzk2XH/VHPz8tB1" home="/home/cloud-user" name="cloud-user" groups="cloud-user"/>
        <user password="$1$AaPVmd9Q$bgmNGnP9oOG54XissaOaF." home="/home/fsuser" name="fsuser" id="10099" groups="fsuser" shell="/sbin/nologin"/>
        <user password="$1$appPNs.6$VB8w6i9e6I07WU4V.o5V0." home="/home/tidb" name="tidb" groups="tidb"/>
    </users>
    <repository type="rpm-md" alias="repo_ceph">
        <source path="http://mirrors.haihangyun.com/centos/7/storage/x86_64/ceph-luminous/"/>
    </repository>
    <repository type="rpm-md" alias="repo_epel">
        <source path="http://mirrors.haihangyun.com/epel/7/x86_64/"/>
    </repository>
    <repository type="rpm-md" alias="repo_os">
        <source path="http://mirrors.haihangyun.com/centos/7/os/x86_64/"/>
    </repository>
    <repository type="rpm-md" alias="repo_updates">
        <source path="http://mirrors.haihangyun.com/centos/7/updates/x86_64/"/>
    </repository>
    <repository type="rpm-md" alias="repo_extras">
        <source path="http://mirrors.haihangyun.com/centos/7/extras/x86_64/"/>
    </repository>
    <repository type="rpm-md" alias="repo_cephdeploy">
        <source path="https://mirrors.aliyun.com/ceph/rpm-luminous/el7/noarch/"/>
    </repository>
    <repository type="rpm-md" alias="repo_samba">
        <source path="https://reposamba.los-cn-north-1.lecloudapis.com"/>
    </repository>
    <repository type="rpm-md" alias="rpms">
        <source path="file:///home/vagrant/works/source/kiwi-descriptions/centos/x86_64/ceph-applicance/rpms"/>
    </repository>
    <repository type="rpm-md" priority="1" alias="kiwi-common-boot">
        <source path="obs://Virtualization:Appliances:Builder/CentOS_7"/>
    </repository>
    <packages type="image">
        <namedCollection name="core"/>
        <namedCollection name="console-internet"/>
        <package name="syslinux"/>
        <package name="grub2"/>
        <package name="kernel"/>
        <package name="plymouth-theme-charge"/>
        <package name="gdisk" bootinclude="true"/>
        <package name="lvm2" bootinclude="true"/>
<!-- utils for our packages -->
        <package name="vim" bootinclude="true"/>
        <package name="ntp"/>
        <package name="tar"/>
        <package name="gzip"/>
        <package name="xz"/>
        <package name="bzip2"/>
        <package name="gzip"/>
        <package name="screen"/>
        <package name="mysql"/>
        <package name="patch"/>
        <package name="augeas"/>
<!-- ceph packages -->
        <package name="fabric"/>
        <package name="ceph"/>
        <package name="ceph-common"/>
        <package name="ceph-deploy"/>
        <package name="nfs-utils" bootinclude="true"/>
        <package name="samba" bootinclude="true"/>
        <package name="samba-vfs-cephfs" bootinclude="true"/>
        <package name="ctdb"/>
        <package name="samba-client" bootinclude="true"/>
        <package name="xfsprogs" bootinclude="true"/>
<!--prometheus packages -->
        <package name="ceph_exporter"/>
        <package name="node-exporter"/>
        <package name="prometheus"/>
        <package name="automata"/>
        <package name="nier"/>
        <package name="niergui"/>
<!-- utils for TiDB -->
        <package name="ntp"/>
<!--tar packages -->
        <archive name="binaries.tar.gz"/>
    </packages>
    <packages type="iso">
        <package name="dracut-kiwi-live"/>
    </packages>
    <packages type="oem">
        <package name="dracut-kiwi-oem-repart"/>
        <package name="dracut-kiwi-oem-dump"/>
    </packages>
    <packages type="bootstrap">
        <package name="filesystem"/>
        <package name="basesystem"/>
        <package name="yum-plugin-priorities"/>
        <package name="grub2-efi-modules"/>
        <package name="grub2-efi"/>
        <package name="shim" arch="x86_64"/>
    </packages>
</image>
